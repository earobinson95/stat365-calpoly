---
title: "Table Design"
subtitle: "Stat 365: Statistical Communication"
format: 
  revealjs:
    theme: [default, ../../slide_custom.scss]
    auto-stretch: false
    # chalkboard: true
editor: source
self-contained: true
execute:
  echo: false
---

## Wednesday, April 24th^[Material from today's lecture from Storytelling with Data and Show Me the Numbers ch 8.]

```{r}
#| include: false
library(tidyverse)
```

Today we will...

-   The role of tables
-   Table design
-   Practice with tables

## The role of tables

Use a table when...[^1]

[^1]: Show Me the Numbers (ch. 3)

-   The display will be used to look up individual values
-   The display will be used to compare individual values rather than a series or trend
-   Precise values are required
-   Values involve more than one unit of measure
-   Values must be presented at various levels of aggregation

## Table Anatomy^[Better Data Visualizations, Jonathan Schwabish]

```{r}
#| echo: false
#| fig-align: center
#| out-width: 75%
knitr::include_graphics("images/table-anatomy.JPG")
```

<!-- Tables will typically come up in -->

<!-- -   Methods section, e.g., provide definitions of terms used in the protocol -->
<!-- -   Results/Discussion section, e.g., help reader compare results at a glance -->

## Table Tips

-   Tables should be self-sufficient and stand-alone. The reader should be able to understand the table without reading your discussion. Use titles, row headings, and column headings to convey:
    -   Purpose
    -   Context
    -   Variables (units of measurement/categories)
    -   Data sources (in footnotes)
    -   Definitions of technical terms
-   Let the data speak for themselves -- Simplicity!
-   Organize material in a meaningful way
-   Tables should never flow across a page break

## Table Example: Childcare Costs

```{r}
#| label: setup

library(tidyverse)
library(kableExtra)

childcare_costs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv')
counties <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/counties.csv')
```

```{r}
# code to create ca_childcare
ca_childcare <- counties |> 
  filter(state_abbreviation == "CA") |> 
  left_join(childcare_costs,
            by = "county_fips_code"
            )
```

::: panel-tabset
### Poor

```{r}
#| echo: false
ca_childcare |> 
  filter(study_year %in% c(2008, 2018)) |> 
  rename(mc_sa = mcsa,
         mfcc_sa = mfccsa) |> 
  pivot_longer(c(mc_sa:mfcc_preschool),
               names_to = c("facility_type", "age"),
               values_to = "weekly_cost",
               names_sep = "_"
               ) |> 
  group_by(study_year, facility_type, age) |> 
  summarize(avg_weekly_cost = mean(weekly_cost),
            sd_weekly_cost = sd(weekly_cost)
            ) |> 
  filter(age == "infant") |> 
  arrange(facility_type) |> 
  select(study_year, facility_type, avg_weekly_cost, sd_weekly_cost) |> 
  knitr::kable(caption = "Table X. Descriptive Statistics on ca_childcare")  |> 
  kable_classic(full_width = F)
```

-   Short, cryptic acronyms
-   References to mc, mfcc, not available to your reader
-   Excessive digits
-   If we want to compare center vs family care we have to jump rows.

### Better

```{r}
#| echo: false
ca_childcare |> 
  filter(study_year %in% c(2008, 2018)) |> 
  rename(mc_sa = mcsa,
         mfcc_sa = mfccsa) |> 
  pivot_longer(c(mc_sa:mfcc_preschool),
               names_to = c("facility_type", "age"),
               values_to = "weekly_cost",
               names_sep = "_"
               ) |> 
  group_by(study_year, facility_type, age) |> 
  summarize(avg_weekly_cost = mean(weekly_cost),
            sd_weekly_cost = sd(weekly_cost)
            ) |> 
  filter(age == "infant") |> 
  arrange(facility_type) |> 
  mutate(facility_type = case_when(facility_type == "mc" ~ "Center-based",
                                   facility_type == "mfcc" ~ "Family-based")
         ) |> 
  select(facility_type, study_year, avg_weekly_cost, sd_weekly_cost) |> 
  knitr::kable(caption = "Table X. Means and Standard Deviations of the Median Weekly Cost for Infant Childcare across the 58 counties in California",
               col.names = c("Facility", "Year", "Mean ($)", "Std. Dev."),
               digits = 1
               ) |> 
  # kable_classic(full_width = F) |> 
  kable_minimal(full_width = F) |>
  footnote(general = "Data source: National Database of Childcare Prices (NDCP)")
```

### Improvements
-   Labels clearly identify the concepts in each row
-   Ordering of rows makes comparison of center vs family care easy
-   The variable can be defined in the data and methods section or a note to the table
-   For a non-scientific article, replace technical labels with everyday synonyms

:::

## Table Design

::: panel-tabset
### Show the Data! Not the boarders.

```{r}
#| echo: false
#| fig-align: center
#| out-width: 100%
knitr::include_graphics("images/table-boarders.png")
```

### Use Whitespace
```{r}
#| echo: false
#| fig-align: center
#| out-width: 100%
knitr::include_graphics("images/table-nowhitespace.JPG")
knitr::include_graphics("images/table-whitespace.JPG")
```

### Text Matters

:::: columns
::: column
Align numbers to the right
```{r}
#| echo: false
#| fig-align: center
#| out-width: 100%
knitr::include_graphics("images/table-alignnumbersright.JPG")
```
:::
::: column
Select your font to be legible
```{r}
#| echo: false
#| fig-align: center
#| out-width: 100%
knitr::include_graphics("images/table-font.JPG")
```
:::
::::
:::

## Variations in tables

:::: columns
::: column
**Unidirectional** categorical items are laid out in one direction only (think long data)

```{r}
#| echo: false
#| fig-align: center
#| out-width: 100%
knitr::include_graphics("images/table-unidirectional.JPG")
```

:::
::: column
**Bidirectional** categorical items are laid out in both directions (think wide data)

```{r}
#| echo: false
#| fig-align: center
#| out-width: 100%
knitr::include_graphics("images/table-bidirectional.JPG")
```

:::
::::

## Highlight what's important!

<br>

**Boldfaced** or *Italic* text

<span style="font-size: 50px;">Size</span>

<div style="color: #6CAAD4;">Color</div> <div style="color: #1C758A;">intensity</div>

<div style="text-align: center;">Position</div>

## Common Errors[^3]

[^3]: Franzblau & Chung, 2012

-   Tables that are too large or too simple
-   Inclusion of nonessential data
-   Failure to use shading and bordering in tables
-   Redundancy with text
-   Excessive precision
-   Not self-explanatory 
-   Design elements interfere with the clarity
-   Inadequate definition of symbols or abbreviations

## Packages for tables in `R`

+ `library(gt)`
+ `library(DT)`
+ `library(kable)`
+ `library(kableExtra)`

# Practice in table design

# Can you sketch out a table of summary statistics you might include in your final group report for your data?

## To do

<!-- -   **Read CwD 3.4:** Tracking the Analysis -->

`r fontawesome::fa("hashtag")` **One-number Story**

- Work on improving your story
- Canvas Submission due Thursday, 4/25

`r fontawesome::fa("headphones")` **Listen to Storytelling with Data Podcasts (Data Viz)** 

- For class next week

